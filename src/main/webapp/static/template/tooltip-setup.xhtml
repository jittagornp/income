<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition  xmlns="http://www.w3.org/1999/xhtml"
                 xmlns:h="http://java.sun.com/jsf/html"
                 xmlns:p="http://primefaces.org/ui"
                 xmlns:ui="http://java.sun.com/jsf/facelets"
                 xmlns:f="http://java.sun.com/jsf/core">
    <script>
        (function($, doc, win) {
            /**
             * define class TooltipBiding
             * for bind tooltip to element DOM 
             * by .tooltip-[POSITON : {n, w, e, s}] style class 
             */
            var TooltipBiding = (function() {

                function bind(selectror, gravity) {
                    $(selectror).each(function() {
                        var $item = $(this);
                        if (!$item.attr('original-title')) {
                            $item.tipsy({
                                gravity: gravity
                            });
                        }
                    });
                }

                function bindAndBlur(selectror, gravity) {
                    $(doc).on('click', selectror, function() {
                        $(selectror).mouseout();
                    });

                    win.addResponseListner(function() {
                        var t = setTimeout(function() {
                            clearTimeout(t);
                            bind(selectror, gravity);
                        }, 500);
                    });
                }

                return {
                    bind: bind,
                    bindAndBlur: bindAndBlur
                };
            }).call(this);

            function bindTitle(selector, titleLabel) {
                var t = setTimeout(function() {
                    clearTimeout(t);
                    $(selector).each(function() {
                        var $that = $(this);
                        var title = $that.attr('title');
                        if (!title) {
                            $that.attr('title', titleLabel);
                        }
                    });
                }, 50);
            }

            $(function() {
                TooltipBiding.bind('.tooltip-n', 'n');
                TooltipBiding.bind('.tooltip-s', 's');
                TooltipBiding.bind('.tooltip-e', 'e');
                TooltipBiding.bind('.tooltip-w', 'w');
                //
                TooltipBiding.bindAndBlur('.tooltip-n', 'n');
                TooltipBiding.bindAndBlur('.tooltip-s', 's');
                TooltipBiding.bindAndBlur('.tooltip-e', 'e');
                TooltipBiding.bindAndBlur('.tooltip-w', 'w');

                TooltipBiding.bind('.ui-dialog-titlebar-close', 's');
                TooltipBiding.bindAndBlur('.ui-dialog-titlebar-close', 's');

                TooltipBiding.bind('.require-title', 'w');
                TooltipBiding.bindAndBlur('.require-title', 'w');

                bindTitle('.require-title', 'บังคับกรอก');
                bindTitle('.ui-dialog-titlebar-close', 'คลิกเพื่อปิด');
                win.addResponseListner(function() {
                    bindTitle('.require-title', 'บังคับกรอก');
                    bindTitle('.ui-dialog-titlebar-close', 'คลิกเพื่อปิด');
                });
            });
        })(jQuery, document, window);
    </script>
</ui:composition>