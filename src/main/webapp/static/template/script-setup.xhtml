<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition  xmlns="http://www.w3.org/1999/xhtml"
                 xmlns:h="http://java.sun.com/jsf/html"
                 xmlns:p="http://primefaces.org/ui"
                 xmlns:ui="http://java.sun.com/jsf/facelets"
                 xmlns:f="http://java.sun.com/jsf/core">
    <script>
        window.IX = window.IX || {};
        window.IX.config = {
            HOST: '#{facesContext.externalContext.requestScheme}://#{facesContext.externalContext.request.getHeader("Host")}',
            CONTEXT_PATH: '#{facesContext.externalContext.requestContextPath}'
        };

        window.IX.callback = function() {};
    </script>
    <script>
        var Proxy = function(origin, callback) {
            return function() {
                var val = callback.apply(this, arguments);
                if (val === false) {
                    return false;
                }

                return origin.apply(this, arguments);
            };
        };
    </script>
    <script>
        (function() {
            window.responseHandlers = [];
            window.responseHandlerSize = 0;
            window.addResponseListner = function(listener) {
                responseHandlers[responseHandlerSize++] = listener;
            };
            /**
             * primefaces 5.0 only
             */
            PrimeFaces.ajax.Response.handle = Proxy(
                    PrimeFaces.ajax.Response.handle,
                    function() {
                        var length = window.responseHandlers.length;
                        while (length !== 0) {
                            window.responseHandlers[--length].apply(this, arguments);
                        }
                    }
            );
        })();
    </script>
</ui:composition>